<!DOCTYPE html>
<html>
<head>
    <title>Fortinet</title>
    <link rel="stylesheet" href="/css/styles.css"/>
    <!-- Add any necessary CSS and JavaScript files -->
</head>
<body>
    <nav class="navbar">    <!--See .navbar in styles.css-->
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="#">Our team</a></li>
          <li><a href="#">Projects</a></li>
          <li><a href="#">Contact</a></li>
          <li>
            <form id="searchForm">
                <input type="search" id="searchInput" name="q" placeholder="Search site" />
                <input type="submit" value="Go!" />
            </form>
           </li>
        </ul>
    </nav>

    <aside class="sidebar">    <!--See .sidebar in styles.css-->
        <a href="#fortiAuthenticator">FortiAuthenticator</a>
        <a href="#fortiAuthenticatorrestapi">REST API Solution</a>
        <a href="#authenticationmethods">Authentication Methods</a>
        <ul>
            <li><a href="#webservicebasicauthentication">Webservice Basic Authentication</a></li>
            <li><a href="#oauthbearertokenauthentication">OAuth Bearer Token Authentication</a></li>
            <li><a href="#sessionbasedauthentication">Session-based authentication</a></li>
        </ul>
    </aside>

    <main>
        <article style="margin-left:200px;">
            <h3 id="fortiAuthenticator">FortiAuthenticator = Standalone Box(as SRX)</h3>
            <img src="https://www.avfirewalls.com/images/FortiAuthenticator/FortiAuthenticator-200E.jpg" alt="Fortinet Authenticator"
            style="width:100px;height:100px;">

            <dl><strong>What?</strong></dl>
            <dd>
                - <a href="https://www.fortinet.com/content/dam/fortinet/assets/data-sheets/FortiAuthenticator.pdf">Data Sheet</a> <br>
                - This is a IAM device which provides Authentication(using RADIUS, LDAP), Two Factor Authentication(token)
                IEEE802.1X(wireless) Support, User Identification, Certificate Management, Integration(third party RADIUS 
                and LDAP authentication systems) <br>
                - The REST API can also be used to integrate with external provisioning systems.
            </dd>

            <h4 id="fortiAuthenticatorrestapi">REST API Solution (Version 6.6.0)</h4>
            <dl><strong>
                <a href="https://community.fortinet.com/t5/FortiGate/Technical-Tip-About-REST-API/ta-p/195425">
                    Usage of REST API Method</a></strong></dl>
            <dd>
                Retrieve(GET)  system logs and statistics<br>
                Create(POST), Update(PUT), delete configuration settings
            </dd>

            <dl><strong><a href="https://docs.fortinet.com/document/fortiauthenticator/6.6.0/rest-api-solution-guide/504500/supported-api-methods">
                    Supported Methods</a></strong></dl>

            <table>
                <tr>
                    <th>Method</th>
                    <th>URL</th>
                    <th>Operation description</th>
                    <th>Success response code</th>
                </tr>
                <tr>
                    <td>GET(list)</td>
                    <td>/[resource]/[id]/</td>
                    <td>Retrieve a specific resource with ID id from the endpoint</td>
                    <td>200 ok</td>
                </tr>
                <tr>
                    <td>POST</td>
                    <td>/[resource]/</td>
                    <td>Create a new resource on the given endpoint. </td>
                    <td>201 created</td>
                </tr>
                <tr>
                    <td>PUT(list)</td>
                    <td>/[resource]/</td>
                    <td>Update all of the resources for the given endpoint</td>
                    <td>204 NO CONTENT</td>
                </tr>
                <tr>
                    <td>PUT(detail)</td>
                    <td>/[resource]/[id]/</td>
                    <td>Update an existing item specified with ID id</td>
                    <td>204 NO CONTENT</td>
                </tr>
                <tr>
                    <td>DELETE(list)</td>
                    <td>/[resource]/</td>
                    <td>Delete all resources from an endpoint</td>
                    <td>204 NO CONTENT</td>
                </tr>
                <tr>
                    <td>DELETE(detail)</td>
                    <td>/[resource]/[id]/</td>
                    <td>Delete an existing resource specified with ID id from an endpoint</td>
                    <td>204 NO CONTENT</td>
                </tr>
            </table>

            <h4 id="authenticationmethods"><strong>Authentication Methods for REST Endpoints</strong></h4>

            <dt id="webservicebasicauthentication"><strong>1. User Credentials and API Key (Webservice Basic Authentication)</strong></dt>
            <dd>In every request client has to pass username, API_Key to server</dd>
            <pre class="mermaid">
                sequenceDiagram
                    participant User
                    participant User's abc@gmail.com
                    participant User's Browser
                    participant FortiAuthenticator-Web-Interface

                    note over User's Browser: Open FortiAuthenticator Device's Web<br> Interface in web brower
                    User's Browser ->> FortiAuthenticator-Web-Interface: Login (Administrator)
                    note over FortiAuthenticator-Web-Interface: user management:<br>Create a new user>Role=Admin<br>Web service access=Enable<br>user Email=abc@gmail.com
                    FortiAuthenticator-Web-Interface ->> User's abc@gmail.com: Send API_Key(xxx) to user email
                    note over FortiAuthenticator-Web-Interface: Autogenerated Web_Service_Key<br>This is used to authenticate API_key sent on mail
                    note over User: https://[server_name]/api/[api_version]/[resource]/<br>https://FortiAuthenticator/api/v1/[resource]/id
                    note over User: curl -k -v -u "username:password=API_KEY(xxx)" https://192.168.0.122/api/v1/?format=json
                    User ->> FortiAuthenticator-Web-Interface: GET /api/v1/?format=json HTTP/1.1 Host: 192.168.0.122 Authorization: Basic username:password=API_KEY(xxx)
            </pre>

            <dt id="oauthbearertokenauthentication"><strong>
                <a href="/Networking/OSI-Layers/Layer-7/OAuth.html#oauth">2. OAuth Bearer Token Authentication</a></strong></dt>

            <dt id="sessionbasedauthentication"><strong>
                <a href="https://community.fortinet.com/t5/FortiGate/Technical-Tip-About-REST-API/ta-p/195425">3. Session-based authentication</a>
            </strong></dt>
            <dd>The authentication is valid per login session</dd>
            <pre class="mermaid">
                sequenceDiagram
                    participant User
                    participant User's Browser
                    participant FortiAuthenticator
                    participant FortiAuthenticator-Web-Interface

                    note over User's Browser: Open FortiAuthenticator Device's Web<br> Interface in web brower
                    User's Browser ->> FortiAuthenticator-Web-Interface: Login (Administrator)
                    note over FortiAuthenticator-Web-Interface: user management:<br>Create a new user>Generate client_id,secret
                    User ->> FortiAuthenticator: POST /logincheck HTTP/1.1<br>Content-Type: application/x-www-form-urlencoded<br>username=client_id&secretkey=client_secret&ajax=1
                    note over FortiAuthenticator: Valid Login
                    FortiAuthenticator ->> User: HTTP Response (APSCOOKIE=123, ccsrftoken=456)
                    note over User: Extract CSRF token from the 'ccsrftoken' cookie.<br>Will use in further requests
                    User ->> FortiAuthenticator: POST /some_endpoint HTTP/1.1<br>X-CSRFTOKEN:456<br>{ "data": "example" }
                    note over FortiAuthenticator: This is valid token
                    User ->> FortiAuthenticator: POST /logout HTTP/1.1 {End Session}
                    note over FortiAuthenticator: Invalidate authentication cookie and CSRF token 
            </pre>

        </article>
    </main>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    </script>
</body>
</html>
